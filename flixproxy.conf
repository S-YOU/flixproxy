#
# flixproxy.conf
#
# This file is in TOML format, see: https://github.com/toml-lang/toml
#

##
# Logging.
##
[[logging]]
destination = "stdout"
format = "terminal"
level = "debug"

[[logging]]
destination = "/tmp/flixproxy.log"
format = "logfmt"
level = "debug"

#[[logging]]
#destination = "/tmp/flixproxy.jsonlog"
#format = "json"
#level = "debug"

#[[logging]]
#destination = "syslog"
#format = "logfmt"
#level = "info"

##
# Access control
##
[[acl.users]]
allow = false
cidr = "192.168.0.253/32"
[[acl.users]]
allow = true
cidr = "192.168.0.0/16"
[[acl.users]]
allow = true
cidr = "10.0.0.0/8"

#[[acl.other]]
#allow = true
#cidr = "192.0.2.0/24"

##
# DNS proxy settings
# Can be repeated to start several instances of the proxy.
# Comment out to disable.
##
[[dns]]
#
# Identifier of this proxy instance (for logging purposes when there are
# several proxy instances).
#id = "foo"
#
# IP and port number to listen on. If IP is omitted, listens on all IPs.
listen = "192.168.0.10:53"
#
# Allowed client IP addresses ACL.
acl = "users"
#
# DNS requests without local answer are forwarded to the following address.
# Usually you want to forward to a local or remote normal DNS resolver
# such as unbound or bind.
forwarder = "127.0.0.1:53"
#
# DNS RRs that we hand out as answers if the query matches.
# If there is no match, the request is proxied to the forwarder address.
# Asterisk * is recognized as a wild card.
spoof = """
	netflix.com.				A	192.168.0.10
	*.netflix.com.		3600		A	192.168.0.10
	test.example.com.	300	IN	A	127.0.0.1
	test2.example.com.			A	127.0.0.1
	test2.example.com.			AAAA	::1
	test3.example.com.			A	127.0.0.1
	test3.example.com.			A	127.0.0.2
	test3.example.com.			A	127.0.0.3
	*.example.net.				A	127.0.0.1
	*.example.net.				A	127.0.0.2
"""

##
# HTTP proxy settings
# Can be repeated to start several instances of the proxy.
# Comment out to disable.
##
[[http]]
#
# Identifier of this proxy instance (for logging purposes when there are
# several proxy instances).
#id = "foo"
#
# IP and port number to listen on. If IP is omitted, listens on all IPs.
listen = ":80"
#
# Allowed client IP addresses ACL.
acl = "users"
#
# Allowed proxying destinations.
# Asterisk * is recognized as a wild card.
upstreams = [ "*.netflix.com:80" ]
#
# Time limit for waiting for HTTP request on a new connection.
deadline = 60
#
# Idle time limit for proxied connection.
idle = 600
#
# Request logging.
logrequest = true

##
# TLS proxy settings
# Can be repeated to start several instances of the proxy.
# Comment out to disable.
##
[[tls]]
#
# Identifier of this proxy instance (for logging purposes when there are
# several proxy instances).
#id = "foo"
#
# IP and port number to listen on. If IP is omitted, listens on all IPs.
listen = ":443"
#
# Allowed client IP addresses ACL.
acl = "users"
#
# Allowed proxying destinations.
# Asterisk * is recognized as a wild card.
upstreams = [ "*.netflix.com:443" ]
#
# Time limit for waiting for TLS Client Hello message on a new connection.
deadline = 60
#
# Idle time limit for proxied connection.
idle = 600

# eof
